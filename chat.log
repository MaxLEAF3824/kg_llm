model.py: INFO: init_model(): 76:	Model loaded in 24.2 seconds
model.py: INFO: init_model(): 77:	Model loaded from /home/cs/yangyuchen/guoyiqiu/kg_llm/scripts/output/llama_hc_kg_ft
__init__.py: INFO: init_adapter(): 37:	Using adapter Llama2Adapter
model.py: INFO: accel_model(): 90:	Accelerate model with None
chat.py: INFO: main(): 177:	Round 1
chat.py: INFO: main(): 180:	User input: A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions.\n\n##USER:\nA 42-year-old woman comes to the emergency department because of a 2-day history of right upper abdominal pain and nausea. She is 163 cm (5 ft 4 in) tall and weighs 91 kg (200 lb); her BMI is 34 kg/m2. Her temperature is 38.5\u00b0C (101.3\u00b0F). Physical examination shows a distended abdomen and right upper quadrant tenderness with normal bowel sounds. Laboratory studies show:\nLeukocyte count 14,000/mm3\nSerum\nTotal bilirubin 1.1 mg/dL\nAST 32 U/L\nALT 40 U/L\nAlkaline phosphatase 68 U/L\nAbdominal ultrasonography is performed, but the results are inconclusive. Cholescintigraphy shows the intrahepatic bile ducts, hepatic ducts, common bile duct, and proximal small bowel. Which of the following is the most likely cause of this patient's symptoms?\" Options: A: Autodigestion of pancreatic parenchyma, B: Hypomotility of the gallbadder, C: Fistula between the gallbladder and small intestine, D: Infection with a hepatotropic virus, E: Obstruction of the cystic duct\n\n##ASSISTANT:\n
chat.py: INFO: main(): 188:	Input ids:
tensor([[    1,   518, 25580, 29962,  3532, 14816, 29903,  6778,    13,  3492,   526,   263,  8444, 29892,  3390,  1319,
           322, 15993, 20255, 29889, 29849,  1234,   408,  1371,  3730,   408,  1950, 29892,  1550,  1641,  9109, 29889,
          3575,  6089,   881,   451,  3160,   738, 10311,  1319, 29892,   443,   621,   936, 29892, 11021,   391, 29892,
          7916,   391, 29892,   304, 27375, 29892, 18215, 29892,   470, 27302,  2793, 29889,  3529,  9801,   393,   596,
         20890,   526,  5374,   635,   443,  5365,  1463,   322,  6374,   297,  5469, 29889,    13,    13,  3644,   263,
          1139,   947,   451,  1207,   738,  4060, 29892,   470,   338,   451,  2114,  1474, 16165,   261,   296, 29892,
          5649,  2020,  2012,   310, 22862,  1554,   451,  1959, 29889,   960,   366,  1016, 29915, 29873,  1073,   278,
          1234,   304,   263,  1139, 29892,  3113,  1016, 29915, 29873,  6232,  2089,  2472, 29889,    13, 29966,   829,
         14816, 29903,  6778,    13,    13, 29909, 13563,  1546,   263, 12758,  1404,   322,   385, 23116, 21082, 20255,
         29889,   450, 20255,  4076,  8444, 29892, 13173, 29892,   322,  1248,   568,  6089,   304,   278,  1404, 29915,
         29879,  5155,  7790, 29876, 29905, 29876,  2277, 11889,  3583, 29876, 29909, 29871, 29946, 29906, 29899,  6360,
         29899,  1025,  6114,  5304,   304,   278, 11176, 14703, 14311,  1363,   310,   263, 29871, 29906, 29899,  3250,
          4955,   310,  1492,  7568,   633,  3129,   979,  6788,   322,   302,  1071, 29874, 29889,  2296,   338, 29871,
         29896, 29953, 29941,  7477,   313, 29945, 11791, 29871, 29946,   297, 29897, 15655,   322,   591,  1141, 29879,
         29871, 29929, 29896, 12118,   313, 29906, 29900, 29900, 27981,   416,   902,   350, 10403,   338, 29871, 29941,
         29946, 12118, 29914, 29885, 29906, 29889,  2439, 10430,   338, 29871, 29941, 29947, 29889, 29945, 29905, 29884,
         29900, 29900, 29890, 29900, 29907,   313, 29896, 29900, 29896, 29889, 29941, 29905, 29884, 29900, 29900, 29890,
         29900, 29943,   467, 11661,   936,  4392,  3381,  3697,   263,  1320,  2760,   633, 29881,  2770,   322,  1492,
          7568, 15448,   424, 10331,   824,   404,   411,  4226, 12580,   295, 10083, 29889, 16715,  7606, 11898,  1510,
          3583, 29876,  3226,  2679, 22502,   371,  2302, 29871, 29896, 29946, 29892, 29900, 29900, 29900, 29914,  4317,
         29941, 29905, 29876,  1748,   398, 29905, 29876, 11536, 13181,   381,   431,   262, 29871, 29896, 29889, 29896,
           286, 29887, 29914, 29881, 29931, 29905, 29876, 28938, 29871, 29941, 29906,   501, 29914, 29931, 29905, 29876,
          1964, 29911, 29871, 29946, 29900,   501, 29914, 29931, 29905, 29876,  2499, 11311,   457,  1374, 25715,   271,
           559, 29871, 29953, 29947,   501, 29914, 29931, 29905, 29876,  4920,  3129,   979,  9238,   509,  1658,  5275,
           338,  8560, 29892,   541,   278,  2582,   526, 22629,  7009,   573, 29889,   678,  6544, 29883,   524,   335,
          1140, 29891,  3697,   278,   938,   336,   354, 29886,  2454,   289,   488,   868,   312, 29879, 29892,   540,
         29886,  2454,   868,   312, 29879, 29892,  3619,   289,   488,   868,   312, 29892,   322, 23203,   284,  2319,
         12580,   295, 29889,  8449,   310,   278,  1494,   338,   278,  1556,  5517,  4556,   310,   445, 16500, 29915,
         29879, 25828,  4835, 29973,  5931, 25186, 29901,   319, 29901,  5202,   397,   335,   602,   310,  7243,  1037,
          2454,   610,   264, 23766,   655, 29892,   350, 29901, 28984,   290,   327,  1793,   310,   278, 11798, 12313,
           672, 29892,   315, 29901,   383,   391,  2497,  1546,   278, 11798,  2204,   328,   672,   322,  2319,   938,
           342,   457, 29892,   360, 29901,   512, 20309,   411,   263,   540,  5031, 28467,   293, 24424, 29892,   382,
         29901,  4250,   303,  4080,   310,   278,   274,   858,   293,   868,   312, 29905, 29876, 29905, 29876,  2277,
         22933,  9047, 13566,  3583, 29876,   518, 29914, 25580, 29962]])
chat.py: INFO: main(): 192:	Input ids with history:
tensor([[    1,   518, 25580, 29962,  3532, 14816, 29903,  6778,    13,  3492,   526,   263,  8444, 29892,  3390,  1319,
           322, 15993, 20255, 29889, 29849,  1234,   408,  1371,  3730,   408,  1950, 29892,  1550,  1641,  9109, 29889,
          3575,  6089,   881,   451,  3160,   738, 10311,  1319, 29892,   443,   621,   936, 29892, 11021,   391, 29892,
          7916,   391, 29892,   304, 27375, 29892, 18215, 29892,   470, 27302,  2793, 29889,  3529,  9801,   393,   596,
         20890,   526,  5374,   635,   443,  5365,  1463,   322,  6374,   297,  5469, 29889,    13,    13,  3644,   263,
          1139,   947,   451,  1207,   738,  4060, 29892,   470,   338,   451,  2114,  1474, 16165,   261,   296, 29892,
          5649,  2020,  2012,   310, 22862,  1554,   451,  1959, 29889,   960,   366,  1016, 29915, 29873,  1073,   278,
          1234,   304,   263,  1139, 29892,  3113,  1016, 29915, 29873,  6232,  2089,  2472, 29889,    13, 29966,   829,
         14816, 29903,  6778,    13,    13, 29909, 13563,  1546,   263, 12758,  1404,   322,   385, 23116, 21082, 20255,
         29889,   450, 20255,  4076,  8444, 29892, 13173, 29892,   322,  1248,   568,  6089,   304,   278,  1404, 29915,
         29879,  5155,  7790, 29876, 29905, 29876,  2277, 11889,  3583, 29876, 29909, 29871, 29946, 29906, 29899,  6360,
         29899,  1025,  6114,  5304,   304,   278, 11176, 14703, 14311,  1363,   310,   263, 29871, 29906, 29899,  3250,
          4955,   310,  1492,  7568,   633,  3129,   979,  6788,   322,   302,  1071, 29874, 29889,  2296,   338, 29871,
         29896, 29953, 29941,  7477,   313, 29945, 11791, 29871, 29946,   297, 29897, 15655,   322,   591,  1141, 29879,
         29871, 29929, 29896, 12118,   313, 29906, 29900, 29900, 27981,   416,   902,   350, 10403,   338, 29871, 29941,
         29946, 12118, 29914, 29885, 29906, 29889,  2439, 10430,   338, 29871, 29941, 29947, 29889, 29945, 29905, 29884,
         29900, 29900, 29890, 29900, 29907,   313, 29896, 29900, 29896, 29889, 29941, 29905, 29884, 29900, 29900, 29890,
         29900, 29943,   467, 11661,   936,  4392,  3381,  3697,   263,  1320,  2760,   633, 29881,  2770,   322,  1492,
          7568, 15448,   424, 10331,   824,   404,   411,  4226, 12580,   295, 10083, 29889, 16715,  7606, 11898,  1510,
          3583, 29876,  3226,  2679, 22502,   371,  2302, 29871, 29896, 29946, 29892, 29900, 29900, 29900, 29914,  4317,
         29941, 29905, 29876,  1748,   398, 29905, 29876, 11536, 13181,   381,   431,   262, 29871, 29896, 29889, 29896,
           286, 29887, 29914, 29881, 29931, 29905, 29876, 28938, 29871, 29941, 29906,   501, 29914, 29931, 29905, 29876,
          1964, 29911, 29871, 29946, 29900,   501, 29914, 29931, 29905, 29876,  2499, 11311,   457,  1374, 25715,   271,
           559, 29871, 29953, 29947,   501, 29914, 29931, 29905, 29876,  4920,  3129,   979,  9238,   509,  1658,  5275,
           338,  8560, 29892,   541,   278,  2582,   526, 22629,  7009,   573, 29889,   678,  6544, 29883,   524,   335,
          1140, 29891,  3697,   278,   938,   336,   354, 29886,  2454,   289,   488,   868,   312, 29879, 29892,   540,
         29886,  2454,   868,   312, 29879, 29892,  3619,   289,   488,   868,   312, 29892,   322, 23203,   284,  2319,
         12580,   295, 29889,  8449,   310,   278,  1494,   338,   278,  1556,  5517,  4556,   310,   445, 16500, 29915,
         29879, 25828,  4835, 29973,  5931, 25186, 29901,   319, 29901,  5202,   397,   335,   602,   310,  7243,  1037,
          2454,   610,   264, 23766,   655, 29892,   350, 29901, 28984,   290,   327,  1793,   310,   278, 11798, 12313,
           672, 29892,   315, 29901,   383,   391,  2497,  1546,   278, 11798,  2204,   328,   672,   322,  2319,   938,
           342,   457, 29892,   360, 29901,   512, 20309,   411,   263,   540,  5031, 28467,   293, 24424, 29892,   382,
         29901,  4250,   303,  4080,   310,   278,   274,   858,   293,   868,   312, 29905, 29876, 29905, 29876,  2277,
         22933,  9047, 13566,  3583, 29876,   518, 29914, 25580, 29962]])
chat.py: INFO: main(): 201:	Output:
tensor([[    1,   518, 25580, 29962,  3532, 14816, 29903,  6778,    13,  3492,   526,   263,  8444, 29892,  3390,  1319,
           322, 15993, 20255, 29889, 29849,  1234,   408,  1371,  3730,   408,  1950, 29892,  1550,  1641,  9109, 29889,
          3575,  6089,   881,   451,  3160,   738, 10311,  1319, 29892,   443,   621,   936, 29892, 11021,   391, 29892,
          7916,   391, 29892,   304, 27375, 29892, 18215, 29892,   470, 27302,  2793, 29889,  3529,  9801,   393,   596,
         20890,   526,  5374,   635,   443,  5365,  1463,   322,  6374,   297,  5469, 29889,    13,    13,  3644,   263,
          1139,   947,   451,  1207,   738,  4060, 29892,   470,   338,   451,  2114,  1474, 16165,   261,   296, 29892,
          5649,  2020,  2012,   310, 22862,  1554,   451,  1959, 29889,   960,   366,  1016, 29915, 29873,  1073,   278,
          1234,   304,   263,  1139, 29892,  3113,  1016, 29915, 29873,  6232,  2089,  2472, 29889,    13, 29966,   829,
         14816, 29903,  6778,    13,    13, 29909, 13563,  1546,   263, 12758,  1404,   322,   385, 23116, 21082, 20255,
         29889,   450, 20255,  4076,  8444, 29892, 13173, 29892,   322,  1248,   568,  6089,   304,   278,  1404, 29915,
         29879,  5155,  7790, 29876, 29905, 29876,  2277, 11889,  3583, 29876, 29909, 29871, 29946, 29906, 29899,  6360,
         29899,  1025,  6114,  5304,   304,   278, 11176, 14703, 14311,  1363,   310,   263, 29871, 29906, 29899,  3250,
          4955,   310,  1492,  7568,   633,  3129,   979,  6788,   322,   302,  1071, 29874, 29889,  2296,   338, 29871,
         29896, 29953, 29941,  7477,   313, 29945, 11791, 29871, 29946,   297, 29897, 15655,   322,   591,  1141, 29879,
         29871, 29929, 29896, 12118,   313, 29906, 29900, 29900, 27981,   416,   902,   350, 10403,   338, 29871, 29941,
         29946, 12118, 29914, 29885, 29906, 29889,  2439, 10430,   338, 29871, 29941, 29947, 29889, 29945, 29905, 29884,
         29900, 29900, 29890, 29900, 29907,   313, 29896, 29900, 29896, 29889, 29941, 29905, 29884, 29900, 29900, 29890,
         29900, 29943,   467, 11661,   936,  4392,  3381,  3697,   263,  1320,  2760,   633, 29881,  2770,   322,  1492,
          7568, 15448,   424, 10331,   824,   404,   411,  4226, 12580,   295, 10083, 29889, 16715,  7606, 11898,  1510,
          3583, 29876,  3226,  2679, 22502,   371,  2302, 29871, 29896, 29946, 29892, 29900, 29900, 29900, 29914,  4317,
         29941, 29905, 29876,  1748,   398, 29905, 29876, 11536, 13181,   381,   431,   262, 29871, 29896, 29889, 29896,
           286, 29887, 29914, 29881, 29931, 29905, 29876, 28938, 29871, 29941, 29906,   501, 29914, 29931, 29905, 29876,
          1964, 29911, 29871, 29946, 29900,   501, 29914, 29931, 29905, 29876,  2499, 11311,   457,  1374, 25715,   271,
           559, 29871, 29953, 29947,   501, 29914, 29931, 29905, 29876,  4920,  3129,   979,  9238,   509,  1658,  5275,
           338,  8560, 29892,   541,   278,  2582,   526, 22629,  7009,   573, 29889,   678,  6544, 29883,   524,   335,
          1140, 29891,  3697,   278,   938,   336,   354, 29886,  2454,   289,   488,   868,   312, 29879, 29892,   540,
         29886,  2454,   868,   312, 29879, 29892,  3619,   289,   488,   868,   312, 29892,   322, 23203,   284,  2319,
         12580,   295, 29889,  8449,   310,   278,  1494,   338,   278,  1556,  5517,  4556,   310,   445, 16500, 29915,
         29879, 25828,  4835, 29973,  5931, 25186, 29901,   319, 29901,  5202,   397,   335,   602,   310,  7243,  1037,
          2454,   610,   264, 23766,   655, 29892,   350, 29901, 28984,   290,   327,  1793,   310,   278, 11798, 12313,
           672, 29892,   315, 29901,   383,   391,  2497,  1546,   278, 11798,  2204,   328,   672,   322,  2319,   938,
           342,   457, 29892,   360, 29901,   512, 20309,   411,   263,   540,  5031, 28467,   293, 24424, 29892,   382,
         29901,  4250,   303,  4080,   310,   278,   274,   858,   293,   868,   312, 29905, 29876, 29905, 29876,  2277,
         22933,  9047, 13566,  3583, 29876,   518, 29914, 25580, 29962, 29933, 29871,     2,     1]], device='cuda:0')
chat.py: INFO: main(): 177:	Round 2
